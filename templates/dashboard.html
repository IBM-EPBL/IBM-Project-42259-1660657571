{%extends 'base.html'%}
{%block title%}
Dashboard
{%endblock%}
{%block content%}
<center>
    <h1>Welcome to Dashboard</h1>
    <div>You have successfully logged in as {{ session['role'] }}</div>
</center>
{% if session['role'] =='user' %}
<center>
    <h1 class="heading">Hello {{ session['name'] }}</h1>
    <div>
        <h1>Your Previous Query :</h1>
        <div>{{ session['query'] }} </div>
        <h1>Your Ticket to the Query:</h1>
        <div>{{ session['ticket'] }}</div>
        <h1>Review Status of the Query:</h1>
        <div>{{ session['review'] }}</div>

    </div>

    <div>
        <div id="add_elem">
            <button id="form" class="btn btn-success" onclick="form_create()">Create Query</button>
            <a class="btn btn-primary" href="{{ url_for('redir') }}">Back to Home</a>
        </div>
    </div>
</center>

{% elif session['role'] == 'agent' %}
<hr>
<center>
    <h1>Assigned Customers</h1>


</center>
{% elif session['role']=='admin' %}
<center>
    <form action="{{ url_for('admin_query') }}" method="POST">
        <h1>All Customers</h1>
        <table class="table table-hover">
            <tr>
                <th scope="col">Name</th>
                <th scope="col">Ticket No</th>
                <th scope="col">Query</th>
                <th scope="col">Query Status</th>
                <th scope="col">Assigned to</th>
                <th scope="col">Assign To</th>
            </tr>

            {% for cus in session['customer'] %}

            <tr>

                <td>
                    <select name="cus_name" >
                        <option value="{{ cus['USERNAME'] }}">{{ cus['USERNAME'] }}</option>
                    </select>
                </td>
                <td>
                    {{ cus['TICKET'] }}
                </td>
                <td>
                    {{ cus['QUERY'] }}
                </td>
                <td>
                    {% if cus['REVIEW_STATUS'] == 1 %}
                    Reviewed
                    {% else %}
                    Not yet Reviewed
                    {% endif %}
                </td>
                <td>{{ cus['ASSIGNED_AGENT'] }}</td>
                <td>
                    <select name="agent_name">
                        <option value="none">Select agent</option>
                        {% for agt in session['agent'] %}
                        <option value="{{ agt['USERNAME'] }}">{{ agt['USERNAME'] }}</option>
                        {% endfor %}

                    </select>
                </td>
            </tr>
            {% endfor %}
            <tr>
                <td colspan="4">
                    <center><input type="submit" value="submit"></center>
                </td>

            </tr>

        </table>
    </form>


    <h1>Agent</h1>

    <table>
        <tr>
            <th>Name</th>
        </tr>

        {% for agt in agent %}
        <tr>
            <td>
                {{ agt['USERNAME'] }}
            </td>
        </tr>
        {% endfor %}


    </table>
</center>
{% else %}
<h1>UnIdentified User</h1>
{% endif %}
{%endblock%}